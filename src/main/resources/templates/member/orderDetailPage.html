<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: header}"/>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Do+Hyeon&display=swap');

    .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
    }

    @media (min-width: 768px) {
        .bd-placeholder-img-lg {
            font-size: 3.5rem;
        }
    }

    @media screen and (max-width: 570px) {

    }

    .form-input {
        border-color: #131825;
        background-color: #182030;
        color: #FFFFFF;
    }


    .form-input:focus {
        background-color: #182030;
        color: #FFFFFF;
    }

    .list-group-item {
        background-color: #182030;
        color: #FFFFFF;
    }

    input[type="text"]:disabled {
        background-color: #182030;
    }

</style>

<body class="d-flex flex-column min-vh-100">

<div th:replace="~{fragments/bodyHeader :: bodyHeader}"/>

<div class="container">
    <main>
        <div class="card m-4" style="background-color: #111620">
            <div class="card-body text-white">
                <div class="py-5 text-center">
                    <h1><i class="bi bi-box-seam"></i></h1>
                    <h2>주문 정보</h2>
                </div>

                <div class="row g-5">
                    <div class="col-md-5 col-lg-4 order-md-last">
                        <h4 class="d-flex justify-content-between align-items-center mb-3">
                            <span class="text-white">주문 정보</span>
                            <span class="badge bg-primary rounded-pill" th:text="${checkoutCompleteDto.getProductCartDtos().size()}">3</span>
                        </h4>
                        <ul class="list-group mb-3">
                            <th:block th:each="cartDto: ${checkoutCompleteDto.getProductCartDtos()}">
                                <li class="list-group-item lh-sm">
                                    <div class="row justify-content-between">
                                        <div class="d-flex align-items-center">
                                            <div class="col-auto me-auto">
                                                <h6 class="mb-1" th:text="${cartDto.getName()}">수경 재배기 Model-2</h6>
                                                <div class="d-flex">
                                                    <h6 class="text-muted m-0">수량:&nbsp;</h6>
                                                    <h6 class="m-0" th:text="${cartDto.getQuantity()}">5</h6>
                                                </div>
                                            </div>
                                            <div class="col-auto">
                                                <div class="d-flex">
                                                    <h6 class="mt-2" th:text="${cartDto.getPrice()}">50,000</h6>
                                                    <h6 class="mt-2">원</h6>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            </th:block>
                            <li class="list-group-item lh-sm">
                                <div class="row justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <div class="col-auto me-auto">
                                            <h6 class="m-0">배송비</h6>
                                        </div>
                                        <div class="col-auto d-flex">
                                            <h6 class="mt-2" th:text="${deliveryPrice}">2500</h6>
                                            <h6 class="mt-2">원</h6>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li class="list-group-item d-flex justify-content-between">
                                <h5>총합</h5>
                                <div class="d-flex">
                                    <h5 th:text="${totalPrice} + ${deliveryPrice}">50,000</h5>
                                    <h5>원</h5>
                                </div>
                            </li>
                        </ul>
                        <div class="d-grid">
                            <th:block th:if="${!reviewd}">
                                <button id="review-btn" class="btn btn-outline-light" type="button" data-bs-toggle="modal"
                                        data-bs-target="#reviewModal">리뷰 남기기
                                </button>
                            </th:block>
                            <th:block th:if="${reviewd}">
                                <button class="btn btn-outline-light" type="button" disabled>이미 리뷰 했습니다</button>
                            </th:block>
                        </div>
                        <div class="d-grid my-3">
                            <button id="waybillModal-btn" class="btn btn-outline-light" type="button" data-bs-toggle="modal"
                                    data-bs-target="#waybillModal">배송 조회
                            </button>
                        </div>
                    </div>
                    <div class="col-md-7 col-lg-8">
                        <h4 class="mb-3">배송 정보</h4>
                        <div class="row g-3">
                            <div class="col-sm-6">
                                <label for="name" class="form-label">받는사람</label>
                                <input type="text" class="form-control form-input" id="name" placeholder="홍길동" disabled
                                       required th:field="${checkoutCompleteDto.receiver}">
                            </div>

                            <div class="col-sm-6">
                                <label for="phoneNumber" class="form-label">전화번호</label>
                                <input type="text" class="form-control form-input" id="phoneNumber" disabled
                                       placeholder="010-0000-0000"
                                       th:field="${checkoutCompleteDto.phoneNumber}"
                                       required>
                            </div>

                            <div class="col-12">
                                <label for="zipcode" class="form-label">우편번호</label>
                            </div>
                            <div class="col-6 mt-0">
                                <input type="text" class="form-control form-input" id="zipcode" placeholder="우편번호"
                                       th:field="${checkoutCompleteDto.zipcode}" disabled
                                       required>
                            </div>

                            <div class="col-12">
                                <label for="address1" class="form-label">주소</label>
                                <input type="text" th:field="${checkoutCompleteDto.address1}"
                                       class="form-control form-input" placeholder="주소" disabled
                                       id="address1">
                            </div>

                            <div class="col-12 col-md-6">
                                <label for="address2" class="form-label">상세주소</label>
                                <input type="text" th:field="${checkoutCompleteDto.address2}"
                                       class="form-control form-input" placeholder="상세주소" disabled
                                       id="address2">
                            </div>
                            <div class="col-12 col-md-6">
                                <label for="extraAddress" class="form-label">참고항목</label>
                                <input type="text" th:field="${checkoutCompleteDto.extraAddress}"
                                       class="form-control form-input" disabled
                                       placeholder="참고항목" id="extraAddress">
                            </div>
                        </div>

                        <hr class="my-4">

                        <h4 class="mb-3">결제 방법</h4>

                        <div class="my-3">
                            <div class="col-6">
                                <h4 th:text="${checkoutCompleteDto.paymentType}">
                                    무통장입급
                                </h4>
                                <th:block th:if="${checkoutCompleteDto.deposit != null}">
                                    <div class="d-flex">
                                        <h5>은행:&nbsp;</h5>
                                        <h5 th:text="${checkoutCompleteDto.deposit.getBank()}"></h5>
                                    </div>
                                    <div class="d-flex">
                                        <h5>입금자명:&nbsp;</h5>
                                        <h5 th:text="${checkoutCompleteDto.deposit.getDepositor()}"></h5>
                                    </div>
                                    <div class="d-flex">
                                        <h5>계좌번호:&nbsp;</h5>
                                        <h5 th:text="${checkoutCompleteDto.deposit.getAccountNumber()}"></h5>
                                    </div>
                                </th:block>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<div class="modal fade" id="reviewModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
     aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="reviewModalLabel">리뷰 작성</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="reviewForm" action="">
                <input type="hidden" name="orderUuid" th:value="${uuid}">
                <div class="modal-body">
                    <th:block th:each="productCartDto: ${checkoutCompleteDto.getProductCartDtos()}">
                        <div>
                            <label th:text="${productCartDto.getName()}"></label>
                            <input type="hidden" th:name="|reviews[${productCartDtoStat.index}][productId]|"
                                   th:value="${productCartDto.getProductId()}">
                            <input type="text" th:name="|reviews[${productCartDtoStat.index}][review]|"
                                   class="form-control my-2" placeholder="리뷰내용" required>
                            <input type="number" th:name="|reviews[${productCartDtoStat.index}][score]|"
                                   class="form-control mb-4" placeholder="별점" required>
                        </div>
                    </th:block>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                    <button type="button" id="review-commit-btn" class="btn btn-primary" >등록</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="successModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
     aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="successModalLabel">리뷰 작성 완료</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                리뷰의 작성이 완료되었습니다 감사합니다!
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="waybillModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">배송 조회</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="chooseCompany">택배사 코드</label>
                    <select class="form-select" id="chooseCompany" title="택배사 선택" onchange="onselectionchange()">
                        <option selected="" disabled="">택배사 선택</option>
                        <option value="04">CJ대한통운</option>
                        <option value="01">우체국택배</option>
                        <option value="05">한진택배</option>
                        <option value="08">롯데택배</option>
                        <option value="06">로젠택배</option>
                        <option value="54">홈픽</option>
                        <option value="24">CVSnet 편의점택배(GS25)</option>
                        <option value="46">CU 편의점택배</option>
                        <option value="23">경동택배</option>
                        <option value="22">대신택배</option>
                        <option value="11">일양로지스</option>
                        <option value="32">합동택배</option>
                        <option value="18">건영택배</option>
                        <option value="17">천일택배</option>
                        <option value="20">한덱스</option>
                        <option value="16">한의사랑택배</option>
                        <option value="12">EMS</option>
                        <option value="25">TNT Express</option>
                        <option value="14">UPS</option>
                        <option value="21">Fedex</option>
                        <option value="26">USPS</option>
                        <option value="34">i-Parcel</option>
                        <option value="33">DHL Global Mail</option>
                        <option value="37">LX판토스</option>
                        <option value="28">GSMNtoN</option>
                        <option value="38">ECMS Express</option>
                        <option value="30">KGL네트웍스</option>
                        <option value="40">굿투럭</option>
                        <option value="45">우리택배(구호남택배)</option>
                        <option value="41">GSI Express</option>
                        <option value="44">SLX택배</option>
                        <option value="47">우리한방택배</option>
                        <option value="52">세방</option>
                        <option value="57">Cway Express</option>
                        <option value="60">YJS글로벌(영국)</option>
                        <option value="51">성원글로벌카고</option>
                        <option value="62">홈이노베이션로지스</option>
                        <option value="63">은하쉬핑</option>
                        <option value="66">Giant Network Group</option>
                        <option value="64">FLF퍼레버택배</option>
                        <option value="53">농협택배</option>
                        <option value="65">YJS글로벌(월드)</option>
                        <option value="67">디디로지스</option>
                        <option value="69">대림통운</option>
                        <option value="70">LOTOS CORPORATION</option>
                        <option value="43">애니트랙</option>
                        <option value="72">성훈물류</option>
                        <option value="71">IK물류</option>
                        <option value="79">로지스밸리택배</option>
                        <option value="81">제니엘시스템</option>
                        <option value="84">스마트로지스</option>
                        <option value="87">이투마스(ETOMARS)</option>
                        <option value="85">풀앳홈</option>
                        <option value="82">프레시솔루션</option>
                        <option value="88">큐런택배</option>
                        <option value="89">두발히어로</option>
                        <option value="91">하이브시티</option>
                        <option value="94">오늘의픽업</option>
                        <option value="93">팬스타국제특송(PIEX)</option>
                        <option value="92">지니고 당일배송</option>
                        <option value="96">로지스밸리</option>
                        <option value="99">롯데국제특송</option>
                        <option value="100">나은물류</option>
                        <option value="101">한샘서비스원 택배</option>
                        <option value="102">배송하기좋은날 (SHIPNERGY)</option>
                        <option value="103">NDEX KOREA</option>
                        <option value="104">도도플렉스(dodoflex)</option>
                        <option value="105">브릿지로지스㈜</option>
                        <option value="106">허브넷로지스틱스</option>
                        <option value="108">MEXGLOBAL</option>
                        <option value="49">A.C.E EXPRESS INC</option>
                        <option value="113">썬더히어로</option>
                        <option value="112">1004홈</option>
                        <option value="114">㈜캐나다쉬핑</option>
                        <option value="110">부릉</option>
                        <option value="117">YUNDA EXPRESS</option>
                        <option value="120">발렉스 특수물류</option>
                        <option value="109">파테크해운항공</option>
                        <option value="119">핑퐁</option>
                        <option value="121">바바바(bababa)</option>
                        <option value="122">BAIMA EXPRESS</option>
                        <option value="123">엔티엘피스</option>
                        <option value="124">LTL</option>
                        <option value="125">GTS 로지스</option>
                        <option value="126">㈜올타코리아</option>
                        <option value="128">판월드로지스틱㈜</option>
                        <option value="95">큐익스프레스</option>
                        <option value="130">UFO로지스</option>
                        <option value="131">딜리래빗</option>
                        <option value="132">지오피</option>
                        <option value="134">에이치케이홀딩스</option>
                        <option value="135">HTNS</option>
                        <option value="13">DHL</option>
                        <option value="138">라스트마일</option>
                        <option value="139">오늘회 러쉬</option>
                        <option value="141">인터로지스</option>
                        <option value="142">탱고앤고</option>
                        <option value="140">직구문</option>
                        <option value="143">투데이</option>
                        <option value="144">큐브플로우(CUBEFLOW)</option>
                    </select>
                </div>
                <div class="form-group my-3">
                    <label for="waybillInput">운송장 번호</label>
                    <input type="number" class="form-control" id="waybillInput" placeholder="운송장 번호">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                <button type="button" id="waybill-btn" class="btn btn-primary">조회</button>
            </div>
        </div>
    </div>
</div>
<div th:replace="~{fragments/footer :: footer}"/>
<script src="/js/util/jquery.serialize-object.min.js"></script>
<script src="/js/member/orderDetail.js"></script>

</body>
</html>